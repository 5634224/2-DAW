# Esto es el fichero de configuración de ProFTPD # Hay que renombrarlo como “/etc/proftpd.conf” # A continuación especificamos una serie de opciones globales. # Éstas pueden ser anuladas en secciones más específicas. # Lo primero es el nombre del servidor: ServerName "Nombre del servidor" # Hemos decidido que va a ser un servidor independiente (“standalone”). ServerType standalone # Para que el servidor no dé información acerca del sistema a potenciales # atacantes, retrasamos la aparición de mensajes de bienvenida con la opción: DeferWelcome on # Tampoco queremos que el servidor muestre los enlaces simbólicos de nuestro # sistema, tan sólo los ficheros que se encuentren dentro del área designada para los usuarios. ShowSymLinks off # La siguiente opción es para que el servidor sea compatible con las #extensiones de seguridad de la RFC 2228. MultilineRFC2228 on # La siguiente opción tiene sentido si se decide usar servidores virtuales #(VirtualHost), una de las múltiples opciones del servidor proftpd. Se deja porque no molesta y # si se opta por ampliar el servidor habría que incluirla de nuevo. DefaultServer on # Permitimos que se sobreescriban los ficheros. # Sólo tendrá sentido en los contextos en que se den permisos de escritura al usuario. AllowOverWrite on # Con este parámetro creamos una “jaula” para el usuario, éste no puede salir # del árbol de directorios dado. Para él, es como si fuera el directorio raíz /. DefaultRoot /home/ftp/ # Los siguientes parámetros son temporizadores de la conexión, vienen dados # en segundos. Desconectan al usuario transcurrido cierto tiempo si no se produce # ninguna transferencia, si no llegan datos o si el usuario está inactivo, respectivamente. TimeoutNoTransfer 600 TimeoutStalled 600 TimeoutIdle 1200 # Estos parámetros definen el fichero (relativo a directorio) en ASCII que se # envía al usuario cuando entra en el sistema (el primero) y la primera vez que entra en cada # directorio (el segundo). # Así el primero se ha de ubicar en el directorio dado por DefaultRoot (suele ser un mensaje de # bienvenida) y el segundo en cada directorio donde queramos dar información al usuario. DisplayLogin welcome.msg DisplayFirstChdir .message # Esto son las opciones que se añaden cuando el usuario hace un ls. LsDefaultOptions “ l” # El 21 es el puerto FTP estándar. Port 21 # La máscara sirve para proteger los archivos y/o directorios que se crean o almacenan. # Definen los permisos de los ficheros. Se puede añadir un segundo argumento para # los directorios, si se quiere que sea distinto. Umask 022 # Para prevenir ataques tipo DoS, especificamos un máximo número de conexiones # abiertas simultáneamente. MaxInstances 30 # Para evitar problemas, especificamos qué usuario y grupo serán los que ejecuten el servidor # en los momentos en que no sea necesario tener permisos de root. User nobody Group nogroup # Aquí viene la parte más delicada: # Primero especificamos las condiciones del directorio donde entra el usuario que se conecta # al servidor. Como se puede observar, el usuario no tiene ningún permiso de escritura, ni # de creación de directorios. Todo lo que puede hacer es descargar ficheros. DenyAll # Ahora especificamos las condiciones del directorio upload, donde el usuario almacenará # sus ficheros: Puede escribir, crear y borrar directorios y ficheros, siempre y cuando sean 5 # suyos. De esto nos aseguramos con una máscara que sólo da permisos al usuario creador # del fichero y/o directorio. Además, los usuarios no pueden descargar nada de lo que # encuentren en este directorio. Umask 077 AllowAll DenyAll # Fin del fichero de configuración.